define(["eldar/ACarouselVista","lib/Utils"],function(t,a){var s=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;return t.extend({_direction:1,init:function(t){this._super(t)},drawItems:function(){for(var t=this.items.length,i=this.designParamsAttributes.steps,e=0;e<t;e++){var o=$(this.items[e]);o.data("pos",e*i),o.data("goto",e*i),s(a.relegate(this,this.renderItem,o,e))}},renderItem:function(t,i){var e=this.items.length,o=this.designParamsAttributes.width,r=this.designParamsAttributes.height,n=this.designParamsAttributes.z,d=this.designParamsAttributes.steps,h=0,m=0,g=t.width(),p=t.height(),u=1,c=t.data("pos")/(e*d)*2*Math.PI;h=Math.sin(c)*o,m=(Math.cos(c)-1)*r,u=(Math.cos(c)+1)*(n/2)+(100-n);var l=2*Math.round(t.data("pos")-e*d/2),f=(Math.cos(c)+1)*(n/2)+(100-n);h+=g/100*(100-f)/2,m+=p/100*(100-f)/2,l=l>=0?l:Math.abs(l)+1,t.css({opacity:u/100,transform:"translateX("+h+"px) translateY("+m+"px) scale("+f/100+")",transformOrigin:"0 0",WebkitTransform:"translateX("+h+"px) translateY("+m+"px) scale("+f/100+")",WebkitTransformOrigin:"0 0",zIndex:l}),t.data("pos")!=t.data("goto")&&(t.data("pos",t.data("pos")+this._direction),t.data("pos",t.data("pos")>=0?t.data("pos"):t.data("pos")+e*d),t.data("pos",t.data("pos")%(e*d))),s(a.relegate(this,this.renderItem,t,i))},clickCardEvent:function(t){this._super(t);var a=this.designParamsAttributes.steps,s=this.items.length,i=$(t.currentTarget).data("goto");this._direction=i<s*a/2?-1:1;for(var e,o=0;o<s;o++)e=$(this.items[o]),e.data("goto",e.data("goto")-i),e.data("goto",e.data("goto")>=0?e.data("goto"):e.data("goto")+s*a),e.data("goto",e.data("goto")%(s*a))}})});