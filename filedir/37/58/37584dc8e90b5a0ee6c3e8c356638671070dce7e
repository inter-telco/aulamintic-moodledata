
var CMI_BLOCK_NAME=["cmi.suspend_data","cmi.launch_data","cmi.comments"];var AICC_URL="";var AICC_SID="";var URL_REQUEST="";var sIsELW="";var tracking=new Object();var trackingReadOnly=new Object();var isInitialized=false;var isHACP=false;var hasNavRequest=false;var oneShotTracking=false;var currentBlockIndex=0;var orderedObjectivesId="";var canCloseWindow=false;var forceAPIDetection=false;var timerId
var exportType='flash';function resizeIE(e){clearTimeout(timerId);timerId=setTimeout(function(){var playerObject=document.getElementById("player");var playerEmbed=document.getElementsByName("player")[0];playerObject.setAttribute("height",0);playerEmbed.setAttribute("height",0);var docHeight=document.documentElement.offsetHeight;playerObject.setAttribute("height",docHeight);playerEmbed.setAttribute("height",docHeight);},100);}
function doStart(sBgColor,sWidth,sHeight,sOneShotTracking,sScalemode,sForceAPIDetection){oneShotTracking=(sOneShotTracking=="1");if((sForceAPIDetection!==undefined)&&(sForceAPIDetection=="1")){forceAPIDetection=true;}
var sURL="player.swf";splitURLArguments();var sInitialized=doLMSInitialize(forceAPIDetection);switch(sInitialized){case"1.2":case"2004":isInitialized=true;initTracking();sURL+="?bAPIBased=1";sURL+="&bIsELW="+sIsELW;sURL+="&scormversion="+sInitialized;if(URL_REQUEST!="")sURL+="&"+URL_REQUEST;if(trackingReadOnly["cmi.core.student_id"])sURL+="&sStudentId="+trackingReadOnly["cmi.core.student_id"];if(trackingReadOnly["cmi.core.student_name"])sURL+="&sStudentName="+trackingReadOnly["cmi.core.student_name"];if(tracking["cmi.core.lesson_location"])sURL+="&sLessonLocation="+tracking["cmi.core.lesson_location"];if(trackingReadOnly["cmi.core.credit"])sURL+="&sCredit="+trackingReadOnly["cmi.core.credit"];if(tracking["cmi.core.lesson_status"])sURL+="&sLessonStatus="+tracking["cmi.core.lesson_status"];if(trackingReadOnly["cmi.core.entry"])sURL+="&sEntry="+trackingReadOnly["cmi.core.entry"];if(trackingReadOnly["cmi.core.lesson_mode"])sURL+="&sLessonMode="+trackingReadOnly["cmi.core.lesson_mode"];if(tracking["cmi.student_preference.audio"])sURL+="&sStudentPreferenceAudio="+tracking["cmi.student_preference.audio"];if(tracking["cmi.student_preference.language"])sURL+="&sStudentPreferenceLanguage="+tracking["cmi.student_preference.language"];if(tracking["cmi.student_preference.speed"])sURL+="&sStudentPreferenceSpeed="+tracking["cmi.student_preference.speed"];if(tracking["cmi.student_preference.text"])sURL+="&sStudentPreferenceText="+tracking["cmi.student_preference.text"];if(tracking["adl.nav.request_valid.continue"])sURL+="&sNavRequestValidContinue="+tracking["adl.nav.request_valid.continue"];if(tracking["adl.nav.request_valid.previous"])sURL+="&sNavRequestValidPrevious="+tracking["adl.nav.request_valid.previous"];sURL+="&nObjectivesCount="+tracking["cmi.objectives._count"];sURL+="&sSuspendData=big";currentBlockIndex=0;var interactions_children=doLMSGetValue("cmi.interactions._children").split(",");var bTrackInteractions=(interactions_children.length>0);sURL+="&bTrackInteractions="+bTrackInteractions;break;case"hacp":sURL+="?AICC_URL="+AICC_URL;sURL+="&AICC_SID="+AICC_SID;sURL+="&bTrackInteractions=1";if(URL_REQUEST!="")sURL+="&"+URL_REQUEST;isHACP=true;break;default:if(URL_REQUEST!="")sURL+="?"+URL_REQUEST;}
sURL+=(sURL.indexOf("?")>-1)?"&":"?";sURL+="sScalemode="+sScalemode;document.writeln('<table width="100%" height="100%" cellspacing="0" cellpadding="0"><tr><td valign="middle" align="center" id="mainCell" bgcolor="'+sBgColor+'">');if(sHeight=="100%"&&navigator.userAgent.match(/MSIE|Trident|Edge/)){sHeight=document.documentElement.offsetHeight;window.onresize=resizeIE;}
if(sInitialized=="false"&&forceAPIDetection){document.writeln('This SCO needs a SCORM compatible LMS to be launched !');}
else{document.writeln('<OBJECT classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="'+getProtocol()+'://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,0,0" ID="player" width="'+sWidth+'" height="'+sHeight+'">');document.writeln('<param name="allowScriptAccess" value="sameDomain">');document.writeln('<param name="movie" value="'+sURL+' ">');document.writeln('<param name="quality" value="high">');document.writeln('<param name="allowFullScreen" value="true" />');document.writeln('<param name="bgcolor" value="'+sBgColor+'">');document.writeln('<EMBED SRC="'+sURL+'" quality="high" bgcolor="'+sBgColor+'" width="'+sWidth+'" height="'+sHeight+'" name="player" align="middle" swLiveConnect="true" allowFullScreen="true" allowScriptAccess="sameDomain" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer">');document.writeln('</EMBED></OBJECT>');}
document.writeln('</td></tr></table>');}
function doQuit(){canCloseWindow=true;if(isInitialized||isHACP){if(tracking["cmi.core.lesson_status"]==null||tracking["cmi.core.lesson_status"]==undefined)tracking["cmi.core.lesson_status"]="incomplete";if(tracking["cmi.core.lesson_status"].toLowerCase().charAt(0)=="n")tracking["cmi.core.lesson_status"]="incomplete";if(oneShotTracking){oneShotTracking=false;for(var str in tracking)doLMSSetValue(str,tracking[str]);doLMSSetValue("cmi.core.lesson_status",tracking["cmi.core.lesson_status"]);}
else{if(tracking["cmi.core.score.raw"]!=null)doLMSSetValue("cmi.core.score.raw",tracking["cmi.core.score.raw"]);if(tracking["cmi.core.session_time"]!=null)doLMSSetValue("cmi.core.session_time",tracking["cmi.core.session_time"]);if(tracking["cmi.core.lesson_status"]!=null)doLMSSetValue("cmi.core.lesson_status",tracking["cmi.core.lesson_status"]);if(tracking["cmi.core.lesson_location"]!=null)doLMSSetValue("cmi.core.lesson_location",tracking["cmi.core.lesson_location"]);if(tracking["cmi.suspend_data"]!=null)doLMSSetValue("cmi.suspend_data",tracking["cmi.suspend_data"]);}
doLMSCommit();doLMSFinish();if(isInitialized){isInitialized=false;}
if(isHACP){canCloseWindow=false;isHACP=false;}}}
function doSendValue(name,value){var buffer=false;if(value==undefined||value=="undefined")return;if(name.indexOf("adl.nav.request")>-1)hasNavRequest=true;switch(name){case"score":name="cmi.core.score.raw";break;case"session_time":name="cmi.core.session_time";break;case"lesson_status":name="cmi.core.lesson_status";break;case"lesson_location":name="cmi.core.lesson_location";break;case"suspend_data":name="cmi.suspend_data";break;case"author_data":name="cmi.core.author_data";break;}
tracking[name]=value;if((isInitialized||isHACP)&&!oneShotTracking){buffer=doLMSSetValue(name,value);}
return buffer;}
function doFSCommand(command,args){args=String(args);command=String(command);switch(command){case"LMSSetValue":var arrayOfArguments=args.split(";");var arg0=arrayOfArguments.shift();var arg1=arrayOfArguments.join(";");doSendValue(arg0,arg1);break;case"LMSCommit":doLMSCommit();break;case"UpdateSessionTime":tracking["cmi.core.session_time"]=args;break;case"UpdateSuspendData":tracking["cmi.suspend_data"]=args;break;case"sendQuit":case"LMSFinish":doQuit();if(canCloseWindow)exitWindow(2);break;case"OnOpenDocument":showDocument(args);break;case"OnGetSuspendDataBlock":sendSuspendDataToPlayer(args);break;case"OnGetObjectivesBlock":sendObjectivesToPlayer(args);break;}}
function doEICommand(command,args){args=String(args);command=String(command);doFSCommand(command,args);return 1;}
function exitWindow(nCounter){var sHTML="";if(nCounter==10){if(!hasNavRequest){sHTML+='Vous pouvez maintenant fermer la fen&ecirc;tre<br/>';sHTML+='Now you can close the window<br/>';sHTML+='Usted puede ahora cerrar la ventana<br/>';}
document.getElementById('mainCell').innerHTML=sHTML;}else{var sWait="";for(i=0;i<nCounter;i++)sWait+=".";sHTML+='Veuillez patienter'+sWait+'<br/>';sHTML+='Please wait'+sWait+'<br/>';sHTML+='Por favor espere'+sWait+'<br/>';document.getElementById('mainCell').innerHTML=sHTML;setTimeout(exitWindow.bind(this,nCounter+1),300);}
if(exportType=='flash'){if(window==window.parent||window.parent==null||window.parent==undefined){window.close();}}else{var windowParent=window.parent;if(windowParent==windowParent.parent||windowParent.parent==null||windowParent.parent==undefined){windowParent.close();}}}
function showDocument(document){var sUserAgent=navigator.userAgent.toLowerCase();if(sUserAgent.indexOf("msie")!=-1){window.open("t_popup_elm_document.html?document="+escape(document),'edoceo_document','');return false;}else{window.open(document,'edoceo_document','');return false;}}
function setFlashVariable(name,value){var movie=null;var movieName="player";if(window.document[movieName]){movie=window.document[movieName];}
else{if(navigator.appName.indexOf("Microsoft Internet")==-1){if(document.embeds&&document.embeds[movieName])movie=document.embeds[movieName];}
else{movie=document.getElementById(movieName);}}
if(movie!=null)movie.SetVariable(name,value);}
function sendSuspendDataToPlayer(sIndex){var sTrackingDataRef=CMI_BLOCK_NAME[currentBlockIndex];if(sTrackingDataRef=="cmi.launch_data"){var sTrackingData=new String(trackingReadOnly[sTrackingDataRef]);}else{var sTrackingData=new String(tracking[sTrackingDataRef]);}
var nL=sTrackingData.length;var n=Math.floor((nL-1)/NB_MAX_SIZE_SUSPEND_DATA)+1;var nIndex=Number(sIndex);if(nIndex>=0&&nIndex<n){setFlashVariable("sSuspendData",sTrackingData.substr(nIndex*NB_MAX_SIZE_SUSPEND_DATA,NB_MAX_SIZE_SUSPEND_DATA));}
else{if(currentBlockIndex<CMI_BLOCK_NAME.length-1){currentBlockIndex++;setFlashVariable("sSuspendData",CMI_BLOCK_NAME[currentBlockIndex]);}
else{setFlashVariable("sSuspendData","stop");}}}
function sendObjectivesToPlayer(sIndex){if(orderedObjectivesId==""&&Number(tracking['cmi.objectives._count'])>0){var aObjectivesId=[];for(var i=0;i<Number(tracking['cmi.objectives._count']);i++){aObjectivesId.push(tracking['cmi.objectives.'+i+'.id']);}
orderedObjectivesId=aObjectivesId.join('|');}
var nL=orderedObjectivesId.length;var n=Math.floor((nL-1)/NB_MAX_SIZE_SUSPEND_DATA)+1;var nIndex=Number(sIndex);if(nIndex>=0&&nIndex<n){setFlashVariable("sOrderedObjectivesId",orderedObjectivesId.substr(nIndex*NB_MAX_SIZE_SUSPEND_DATA,NB_MAX_SIZE_SUSPEND_DATA));}else{setFlashVariable("sOrderedObjectivesId","stop");}}
function isValueInArray(aArray,sValue){var buffer=false;var i=0;var n=aArray.length;while(i<n&&!buffer){buffer=(aArray[i]==sValue);i++;}
return buffer;}
function splitURLArguments(){var win=findParamWindow(window);var parameters=unescape(win.location.search.substring(1));var arrayOfParameters=parameters.split("&");URL_REQUEST="";var n=arrayOfParameters.length;for(var i=0;i<n;i++){var arrayOfArgument=arrayOfParameters[i].split("=");if(arrayOfArgument.length>1){var name=arrayOfArgument[0].toUpperCase();var value=arrayOfArgument[1];switch(name){case"AICC_URL":AICC_URL=value;break;case"AICC_SID":AICC_SID=value;break;case"BISELW":sIsELW=value;break;case"EXPORT":exportType=value;break;default:if(URL_REQUEST!="")URL_REQUEST+="&";URL_REQUEST+=arrayOfParameters[i];break;}}}}
function detectFlash(requiredVersion){var flash2Installed=false;var flash3Installed=false;var flash4Installed=false;var flash5Installed=false;var flash6Installed=false;var flash7Installed=false;var flash8Installed=false;var flash9Installed=false;var flash10Installed=false;var maxVersion=10;var hasRightVersion=false;var buffer='';var strCompleteFlashVersion=getFlashVersion();var flashVersion=parseInt(strCompleteFlashVersion.charAt(strCompleteFlashVersion.indexOf(",")-2)+strCompleteFlashVersion.charAt(strCompleteFlashVersion.indexOf(",")-1));flash2Installed=flashVersion==2;flash3Installed=flashVersion==3;flash4Installed=flashVersion==4;flash5Installed=flashVersion==5;flash6Installed=flashVersion==6;flash7Installed=flashVersion==7;flash8Installed=flashVersion==8;flash9Installed=flashVersion==9;flash10Installed=flashVersion>=10;hasRightVersion=(flashVersion>=requiredVersion);if(hasRightVersion){hasRightVersion=hasRightVersion&&(strCompleteFlashVersion!="9,0,115,0");hasRightVersion=hasRightVersion&&(strCompleteFlashVersion!="9,0,124,0");hasRightVersion=hasRightVersion&&(strCompleteFlashVersion!="10,0,12,36");hasRightVersion=hasRightVersion&&(strCompleteFlashVersion!="10,0,42,34");if(!hasRightVersion){var sProtocol=getProtocol();buffer='<p align="center"><font face="Arial">';buffer+='<br /><br />';buffer+='<a href="'+sProtocol+'://www.adobe.com/go/getflashplayer"><img src="'+sProtocol+'://www.adobe.com/images/shared/download_buttons/get_flash_player.gif" alt="Get Adobe Flash player" title="Get Adobe Flash player" border="0" /></a><br />';buffer+='<br /><br />';buffer+='Cette version de Flash Player n\'est pas compatible. Pour continuer, merci de télécharger la <a href="'+sProtocol+'://www.adobe.com/go/getflashplayer">dernière version</a>.<br />';buffer+='This Flash Player version is not compatible. To continue, please download the <a href="'+sProtocol+'://www.adobe.com/go/getflashplayer">latest version</a>.<br />';buffer+='Esta versión de Flash player no es compatible. Para continuar, gracias por descargar la  <a href="'+sProtocol+'://www.adobe.com/go/getflashplayer">última versión</a>.<br />';buffer+='</font></p>';}}else{var sProtocol=getProtocol();buffer='<p align="center"><font face="Arial">';buffer+='<br /><br />';buffer+='<a href="'+sProtocol+'://www.adobe.com/go/getflashplayer"><img src="'+sProtocol+'://www.adobe.com/images/shared/download_buttons/get_flash_player.gif" alt="Get Adobe Flash player" title="Get Adobe Flash player" border="0" /></a><br />';buffer+='<br /><br />';buffer+='Vous avez besoin de <a href="'+sProtocol+'://www.adobe.com/go/getflashplayer">Flash Player '+requiredVersion+'</a> et d\'autoriser Javascript pour visualiser le contenu de ce site.<br />';buffer+='You need <a href="'+sProtocol+'://www.adobe.com/go/getflashplayer">Flash Player '+requiredVersion+'</a> and allow javascript to see the content of this site.<br />';buffer+='Para visualizar correctamente el contenido de esta página web necesita <a href="'+sProtocol+'://www.adobe.com/go/getflashplayer">Flash Player '+requiredVersion+'</a> y autorizar Javascipt.<br />';buffer+='Diese Website erfordert JavaScript und den aktuellen <a href="'+sProtocol+'://www.adobe.com/go/getflashplayer">Flash Player '+requiredVersion+'</a>.<br />';buffer+='</font></p>';}
return buffer;}
function getFlashVersion(){try{try{var axo=new ActiveXObject('ShockwaveFlash.ShockwaveFlash.6');try{axo.AllowScriptAccess='always';}
catch(e){return'6,0,0';}}catch(e){}
return new ActiveXObject('ShockwaveFlash.ShockwaveFlash').GetVariable('$version').replace(/\D+/g,',').match(/^,?(.+),?$/)[1];}catch(e){try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin){return(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1];}}catch(e){}}
return'0,0,0';}
function getProtocol(){var buffer="http";var sLocation=window.location.toString();var index=sLocation.indexOf('https:');if(index==0)buffer+="s";return buffer;}